{% load staticfiles %}
<div id="lucky-name-result" class="row" style="margin-left:0; margin-right:0">

    <div class="row" id="lucky_name_best"  style="margin-left:0; margin-right:0">
        <div class="col-md-4 text-center">
            <h4><span id="your_name">{{ name }}</span>님과<br>이름점 궁합이 최고입니다</h4>
            {% if best_one.candidate == '문재인' %}
            <img class="img-responsive img-circle" src="{% static 'img/candidate/moon.jpg' %}"/>
            {% elif best_one.candidate == '안철수' %}
            <img class="img-responsive img-circle" src="{% static 'img/candidate/ahn1.jpg' %}"/>
            {% elif best_one.candidate == '안희정' %}
            <img class="img-responsive img-circle" src="{% static 'img/candidate/ahn2.jpg' %}"/>
            {% elif best_one.candidate == '이재명' %}
            <img class="img-responsive img-circle" src="{% static 'img/candidate/lee.jpg' %}"/>
            {% elif best_one.candidate == '심상정' %}
            <img class="img-responsive img-circle" src="{% static 'img/candidate/sim.jpg' %}">
            {% elif best_one.candidate == '유승민' %}
            <img class="img-responsive img-circle" src="{% static 'img/candidate/you.jpg' %}">
            {% elif best_one.candidate == '남경필' %}
            <img class="img-responsive img-circle" src="{% static 'img/candidate/nam.jpg' %}">
            {% elif best_one.candidate == '홍준표' %}
            <img class="img-responsive img-circle" src="{% static 'img/candidate/hong.jpg' %}">
            {% elif best_one.candidate == '손학규' %}
            <img class="img-responsive img-circle" src="{% static 'img/candidate/son.jpg' %}">
            {% endif %}
            <span id="best_candidate">{{ best_one.candidate }}</span><br>
            <span id="best_score">{{ best_one.score }}점</span>
        </div>
        <div class="col-md-4 text-center">
            <div id="lucky_name_result_to" style="width:180px;height:300px;"></div>
        </div>
        <div class="col-md-4 text-center">
            <div id="lucky_name_result_from" style="width:180px;height:300px;"></div>
        </div>
    </div>
    <div class="row"  style="margin-left:0; margin-right:0">
        {% for item in list %}
            {% if forloop.counter != 1 %}
                <div class="col-md-2 text-center">
                     {{ forloop.counter }} 등
                    {% if item.candidate == '문재인' %}
                    <img class="img-responsive img-circle" src="{% static 'img/candidate/moon.jpg' %}"/>
                    {% elif item.candidate == '안철수' %}
                    <img class="img-responsive img-circle" src="{% static 'img/candidate/ahn1.jpg' %}"/>
                    {% elif item.candidate == '안희정' %}
                    <img class="img-responsive img-circle" src="{% static 'img/candidate/ahn2.jpg' %}"/>
                    {% elif item.candidate == '이재명' %}
                    <img class="img-responsive img-circle" src="{% static 'img/candidate/lee.jpg' %}"/>
                    {% elif item.candidate == '심상정' %}
                    <img class="img-responsive img-circle" src="{% static 'img/candidate/sim.jpg' %}">
                    {% elif item.candidate == '유승민' %}
                    <img class="img-responsive img-circle" src="{% static 'img/candidate/you.jpg' %}">
                    {% elif item.candidate == '남경필' %}
                    <img class="img-responsive img-circle" src="{% static 'img/candidate/nam.jpg' %}">
                    {% elif item.candidate == '홍준표' %}
                    <img class="img-responsive img-circle" src="{% static 'img/candidate/hong.jpg' %}">
                    {% elif item.candidate == '손학규' %}
                    <img class="img-responsive img-circle" src="{% static 'img/candidate/son.jpg' %}">
                    {% endif %}
                    <span>{{ item.candidate }}</span><br>
                    <span>{{ item.score }}점</span>
                </div>
            {% endif %}
        {% endfor %}
    </div>

</div>

<script type="text/javascript">


    var network_from = null;
    var network_to = null;

    function destroy() {

        if (network_from !== null) {
            network_from.destroy();
            network_from = null;
        }
        if (network_to !== null) {
            network_to.destroy();
            network_to = null;
        }
    }

    function draw(to_from, nodeList, target) {

        var nodes = nodeList;
        var edges = [];

        // 이름 3글자인 사람들
        name_length = 6;
        var left = 0;
        var right = name_length;
        var left_name = 99;
        var right_name = 0;

        for(var time =0; time < 2; time++){

            for(var last = 0; last < 6;last++){
                edges.push({from: left_name-- , to: right_name++});
            }

            for(var i= name_length - 1; i*2 >= 4; i--){
                for(var j = 0; j <i; j++) {
                    edges.push({from: left, to: right})
                    edges.push({from: left + 1, to: right})
                    left++;
                    right++;
                }
                left++;
            }
            left += 2;
            right += name_length;
            right_name = left;

        }

        // create a network
        var container = document.getElementById(target);
        var data = {
            nodes: nodes,
            edges: edges
        };

        var options = {
            autoResize:true,
            height: '100%',
            width: '100%',
            nodes: {
                font: {
                  size: 50, // px
                 },
                color: {
                  background: '#ffffff',
                },
            },
            layout: {
                hierarchical: {
                    direction: 'DU'
                }
            },
            physics: {
                forceAtlas2Based: {
                  springLength: 100
                },
                stabilization: {
                    enabled: true,
                },
                maxVelocity: 11,
                minVelocity: 0.37,
                solver: 'forceAtlas2Based'
            }
        };
        if(to_from == 'to') {
            network_to = new vis.Network(container, data, options);
        }else{
            network_from = new vis.Network(container, data, options);
        }
    }

$(document).ready(function(){
    destroy();
    draw('to', JSON.parse('{{ to_nodes | escapejs  }}'.replace(/'/gi, "\"")), 'lucky_name_result_to');
    draw('from', JSON.parse('{{ from_nodes | escapejs  }}'.replace(/'/gi, "\"")), 'lucky_name_result_from');

});
</script>
